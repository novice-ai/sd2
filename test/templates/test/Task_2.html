{% extends "global/Base.html" %}
{% load staticfiles otree %}

{% block head_title %}
    項目2
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-1-2">
            {% for field in form %}
                <div class="row">
                    {% formfield field %}
                </div>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <script>
        document.addEventListener("DOMContentLoaded", function (event) {
            let form = document.getElementById('form');
            let nextButton = document.querySelector('.otree-btn-next');
            if (nextButton) {
                nextButton.innerText = '送出';

                // Create and append the span element
                let spanElement = document.createElement('span');
                spanElement.style.marginLeft = '5px';
                spanElement.innerText = '（送出後不得再修改）';

                nextButton.parentNode.appendChild(spanElement);
            }
            // Add the 'novalidate' attribute to the form to suppress default validation messages
            form.setAttribute('novalidate', '');

            form.addEventListener('submit', function (event) {
                let incompleteFields = [];
                let allInputs = form.querySelectorAll('input, select, textarea');
                let min = 0; // Set your min value
                let max = 200; // Set your max value

                for (let input of allInputs) {
                    if (input.hasAttribute('required') && !input.value.trim()) {
                        incompleteFields.push(input);
                    }

                    if (input.name === 'firm_task_2') {
                        let inputValue = parseInt(input.value);
                        if (isNaN(inputValue) || inputValue < min || inputValue > max) {
                            event.preventDefault();
                            alert('請填入 0 至 200 的整數');
                            return; // Stop further processing if needed
                        }
                    }
                }
                if (incompleteFields.length > 0) {
                    event.preventDefault();
                    alert('請完整回答再送出');
                    // You can customize the error handling further if needed
                }
            });

            // Change the text of the "Next" button to "下一頁"
           
        });
    </script>
{% endblock %}
